---
layout: post                          
title: 扔鸡蛋问题             
subtitle:                             
date: 2019-07-17                      
author: luojiaqi                      
header-img: img/post-bg-re-vs-ng2.jpg 
catalog: true                         
tags:                                 
    算法笔记                             
---

# 题目：扔鸡蛋问题

有**2**个鸡蛋，从**100**层楼往下扔，以此来测试鸡蛋的硬度。比如鸡蛋在第9层没有摔碎，在第10层摔碎了，那么鸡蛋不会摔碎的临界点就是9层。

**问：如何用最少的尝试次数，测试出鸡蛋不会摔碎的临界点？**

**注意：这道题只给了2个鸡蛋，意思就是你可以尝试多次，但如果在得到答案之前就把2个鸡蛋都摔碎了，那么就无法得到答案。**

### 最笨的方法 

从第1层开始扔

如果第1层没碎就换到第2层，

如果第2层没碎就换到第3层

...

这样最坏的情况是临界点是100层，那么需要尝试100次。不过这样只需要消耗一个鸡蛋。。。这不重要。

### 二分法

类似二分查找，把鸡蛋从一半楼层（50层）开始扔。

如果第1个鸡蛋在50层摔碎了，第2个鸡蛋就从第1层开始扔，一层一层上升一直到49层；

> 为什么不接着二分从25层开始？
>
> 因为第1个鸡蛋已经碎了，只剩一个鸡蛋了，如果第2个鸡蛋在25层摔碎了就得不到答案了，所以保守起见从1层开始。

如果第1个鸡蛋在50层没碎，就继续二分，在剩余楼层的一半（75层）往下扔。

> 为啥这里可以接着二分？因为第1个鸡蛋也没碎，手里还是有两个鸡蛋，就跟原问题一样了。

...

这个方法最坏的情况是临界点在50层，需要尝试1+49=50次。

### 开根号

二分法中，平均下来第1个鸡蛋的尝试次数是要小于第2个鸡蛋的，如何让两个鸡蛋的尝试次数尽可能平均？

做一个平方根运算，100的平方根是10.我们尝试每10层扔一次，第一次从10层扔，第二次从20层...一直到100层。

最好的情况是第10层碎掉，尝试次数为1+9=10。

最坏的情况是第100层碎掉，尝试次数为10+9=19。

#### 小优化

从第15层开始扔，接下来从25层...一直到95层。

最坏的情况是第95层碎掉，尝试次数为9+9=18。

### 方程解法

直接思考出扔鸡蛋的方式比较困难，尝试逆转思路。

**假设问题存在最优解，这个最优解的最坏尝试次数是x次，那么第一次扔鸡蛋应该选择哪一层？**

**假设第一次扔在x+1层：**

如果第1个鸡蛋碎了，那么第2个鸡蛋只能从第1层一层一层开始扔，一直到x层。这样总共尝试了1+x次，这与假设尝试次数为x相悖。所以第一次扔的楼层必须小于x+1层。

**假设第一次扔在x-1层：**

如果第1个鸡蛋碎了，那么第2个鸡蛋只能从第1层开始扔，一直到x-2层。这样总共尝试了1+x-2=x-1次，这与假设相悖，因为假设是最优解为x，不可能有比x更小的尝试次数。

**综上，在假设前提下，第一次应该选择在x层。**



如果第一次选择x层，但没有碎，第二次应该选择哪一层？

如果第一次没碎，也就是说我们手里还是有两个鸡蛋，那么问题就转化为：2个鸡蛋在100-x层楼往下扔，尝试次数不超过x-1次。

> 为什么这里的尝试次数为x-1？
>
> 因为在之前的假设中，我们假设原问题的最优解的最坏情况需要尝试x次，现在我们已经尝试了1次，那么子问题的限制就应该是x-1次。

这样一来，按照之前的推理，第二次应该选择这100-x层楼中的第x-1层，也就是绝对楼层的第x+(x-1)层。

如果鸡蛋还没碎，那么第三次就选择在100-(x+(x-1))层中的第x-2层，也就是绝对楼层的第x+(x-1)+(x-2)层。

如果鸡蛋还没碎，那么第四次就选择在100-(x+(x-1)+(x-2))层中的第x-3层，也就是绝对楼层的第x+(x-1)+(x-2)+(x-3)层。

...

我们上面假设最优解的最差情况尝试了x次，那么尝试了x次后就会到达楼层：

x+(x-1)+(x-2)+(x-3)+...+2+1

总共x项，每一项代表每一次跨越的层数，加起来就等于尝试x次后最终到达的楼层，这个楼层数必须大于等于100，不然与原问题条件不符。所以有：

x+(x-1)+(x-2)+(x-3)+...+2+1>100

x>13.6约等于14。

也就是说，最优解在最坏情况下的尝试次数是14次，第一次扔鸡蛋是在14层。

如果第1个鸡蛋一直没碎，那么尝试的层数为：

**14， 27， 39， 50， 60， 69， 77， 84， 90， 95， 99， 100**

举个栗子，假设鸡蛋的临界点为65层，那么第1个鸡蛋扔出的楼层为14，27，39，50，60，69，在69层碎了，那么第2个鸡蛋就需要从61层开始扔：61，62，63，64，65，66，第2个鸡蛋在66层碎了。

尝试次数为6+6=12<14。

